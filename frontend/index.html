<!-- @format -->

<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <title>Upload de Áudio</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-100 min-h-screen flex flex-col">
    <!-- Header -->
    <header
      class="bg-blue-600 text-white shadow flex items-center justify-between px-8 py-4"
    >
      <div class="flex items-center space-x-8">
        <span class="text-2xl font-bold">Saúde.AI</span>
        <nav class="flex space-x-6">
          <a href="#" class="hover:underline">Consultas</a>
          <a href="#" class="hover:underline">Pacientes</a>
          <a href="#" class="hover:underline">Relatórios</a>
          <a href="#" class="hover:underline">Configurações</a>
        </nav>
      </div>
      <!-- Perfil do Médico -->
      <div class="flex items-center space-x-3">
        <img
          src="https://randomuser.me/api/portraits/men/32.jpg"
          alt="Perfil"
          class="w-10 h-10 rounded-full border-2 border-white"
        />
        <div>
          <div class="font-semibold">Dr. João Silva</div>
          <div class="text-xs text-blue-200">Cardiologista</div>
        </div>
      </div>
    </header>

    <main class="flex flex-1 w-full justify-center items-start mt-8 space-x-8">
      <!-- Slider lateral simulando abas -->
      <aside
        class="w-40 bg-white rounded-xl shadow-lg p-4 flex flex-col space-y-4"
      >
        <button
          class="flex items-center space-x-2 px-3 py-2 rounded bg-blue-100 text-blue-700 font-semibold"
        >
          <span>Consultas</span>
          <span
            class="ml-auto bg-blue-500 text-white text-xs px-2 py-0.5 rounded-full"
            >3</span
          >
        </button>
        <button
          class="flex items-center space-x-2 px-3 py-2 rounded hover:bg-gray-100"
        >
          <span>Pacientes</span>
        </button>
        <a
          href="report.html"
          class="flex items-center space-x-2 px-3 py-2 rounded hover:bg-gray-100"
        >
          <span>Relatórios</span>
        </a>
        <button
          class="flex items-center space-x-2 px-3 py-2 rounded hover:bg-gray-100"
        >
          <span>Configurações</span>
        </button>
      </aside>
      <!-- Conteúdo principal -->
      <section class="flex-1 flex flex-col pr-8">
        <div class="p-8 bg-white shadow-xl rounded-2xl w-full mb-10">
          <div class="mb-6 flex items-center justify-between">
            <h1
              class="text-2xl font-extrabold mb-6 text-blue-700 flex items-center gap-2"
            >
              <span
                class="inline-flex items-center justify-center bg-blue-100 rounded-full"
                style="width: 44px; height: 44px; border-radius: 15px"
              >
                <svg
                  class="w-6 h-6 text-blue-500"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M12 4v16m8-8H4"
                  ></path>
                </svg>
              </span>
              Registrar Consultas
            </h1>
         
            <div class="flex items-center space-x-3">
              <button
                id="btnAddConsulta"
                class="px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold transition"
              >
                Nova Consulta
              </button>
                <button
                id="btnLoadConsulta"
                class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-semibold transition"
                >
                Carregar Consulta
                </button>
              <!-- Modal Upload Consulta -->
<div id="modalUpload" class="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 hidden">
  <div class="bg-white rounded-xl shadow-lg p-8 w-full max-w-md relative">
    <button id="closeModal" class="absolute top-3 right-3 text-gray-400 hover:text-gray-700 text-xl">&times;</button>
    <h2 class="text-xl font-bold mb-4 text-blue-700">Upload de Áudio da Consulta</h2>
    <form id="formUpload">
      <label for="fileInput" class="block text-sm font-medium text-blue-700 mb-2">
        Selecione o arquivo de áudio
      </label>
      <input
        id="fileInput"
        type="file"
        accept="audio/*"
        class="mb-6 w-full border-2 border-blue-200 rounded-lg px-4 py-3 focus:outline-none focus:border-blue-500 transition file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:bg-blue-500 file:text-white file:font-semibold file:cursor-pointer hover:file:bg-blue-600"
        required
      >
      <button type="submit" class="w-full px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold transition">Gerar Arquivo</button>
      <div id="loadingDiv" class="flex justify-center items-center mt-4 hidden">
        <svg class="animate-spin h-6 w-6 text-blue-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path>
        </svg>
      </div>
      <div id="resultDiv" class="mt-4"></div>
    </form>
  </div>
</div>

<script>
const btnLoadConsulta = document.getElementById('btnLoadConsulta');
const modalUpload = document.getElementById('modalUpload');
const closeModal = document.getElementById('closeModal');
const formUpload = document.getElementById('formUpload');
const fileInput = document.getElementById('fileInput');
const loadingDiv = document.getElementById('loadingDiv');
const resultDiv = document.getElementById('resultDiv');

// Abrir e fechar modal
btnLoadConsulta.onclick = () => modalUpload.classList.remove('hidden');
closeModal.onclick = () => modalUpload.classList.add('hidden');
modalUpload.onclick = (e) => { if (e.target === modalUpload) modalUpload.classList.add('hidden'); };

// Upload e processamento
formUpload.onsubmit = async (e) => {
  e.preventDefault();
  const file = fileInput.files[0];
  if (!file) return;

  const formData = new FormData();
  formData.append("file", file);

  loadingDiv.classList.remove("hidden");
  resultDiv.innerHTML = "";

  try {
    const response = await fetch("http://127.0.0.1:5000/transcrever", {
      method: "POST",
      body: formData
    });

    const data = await response.json();

    resultDiv.innerHTML = `
      <h2 class="text-xl font-bold">Transcrição:</h2>
      <p class="mt-2">${data.transcricao}</p>
      <h2 class="text-xl font-bold mt-4">Relatórios:</h2>
      <pre class="mt-2 bg-gray-100 p-2 rounded">${JSON.stringify(data.relatorios, null, 2)}</pre>
    `;
  } catch (err) {
    resultDiv.innerHTML = `<p class="text-red-500">Erro: ${err.message}</p>`;
  } finally {
    loadingDiv.classList.add("hidden");
    // opcional: modalUpload.classList.add('hidden'); // se quiser fechar automaticamente
    formUpload.reset();
  }
};
</script>
            </div> </div>
            <div class="space-y-6">
              <div class="flex flex-col gap-3">
                <!-- Lista de pacientes com horário e botão para começar consulta -->
                <div
                  class="flex items-center justify-between bg-blue-50 rounded-lg p-4 shadow mb-2"
                >
                  <div>
                    <div class="font-bold text-blue-700">Maria Oliveira</div>
                    <div class="text-sm text-blue-500">Horário: 09:00</div>
                  </div>
                  <button
                    class="px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold transition"
                  >
                    Começar Consulta
                  </button>
                </div>
                <div
                  class="flex items-center justify-between bg-blue-50 rounded-lg p-4 shadow mb-2"
                >
                  <div>
                    <div class="font-bold text-blue-700">Carlos Souza</div>
                    <div class="text-sm text-blue-500">Horário: 09:30</div>
                  </div>
                  <button
                    class="px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold transition"
                  >
                    Começar Consulta
                  </button>
                </div>
              </div>
              <!-- Calendário da semana -->
              <div class="mt-6">
                <h2 class="text-lg font-semibold text-blue-700 mb-2">
                  Consultas da Semana
                </h2>
                <div
                  class="bg-blue-50 rounded-lg p-4 shadow flex flex-col gap-2"
                >
                  <div
                    class="grid grid-cols-7 gap-2 text-center text-sm font-medium text-blue-600 mb-2"
                  >
                    <div>Seg</div>
                    <div>Ter</div>
                    <div>Qua</div>
                    <div>Qui</div>
                    <div>Sex</div>
                    <div>Sab</div>
                    <div>Dom</div>
                  </div>
                  <div class="grid grid-cols-7 gap-2">
                    <!-- Exemplo de células do calendário, substitua por dados reais -->
                    <div
                      class="bg-white rounded-lg p-2 border border-blue-100 flex flex-col items-center"
                    >
                      <span class="font-bold">10</span>
                      <span class="text-xs text-blue-500">2 consultas</span>
                    </div>
                    <div
                      class="bg-white rounded-lg p-2 border border-blue-100 flex flex-col items-center"
                    >
                      <span class="font-bold">11</span>
                      <span class="text-xs text-blue-500">1 consulta</span>
                    </div>
                    <div
                      class="bg-white rounded-lg p-2 border border-blue-100 flex flex-col items-center"
                    >
                      <span class="font-bold">12</span>
                      <span class="text-xs text-blue-500">3 consultas</span>
                    </div>
                    <div
                      class="bg-white rounded-lg p-2 border border-blue-100 flex flex-col items-center"
                    >
                      <span class="font-bold">13</span>
                      <span class="text-xs text-blue-500">0</span>
                    </div>
                    <div
                      class="bg-white rounded-lg p-2 border border-blue-100 flex flex-col items-center"
                    >
                      <span class="font-bold">14</span>
                      <span class="text-xs text-blue-500">1 consulta</span>
                    </div>
                    <div
                      class="bg-white rounded-lg p-2 border border-blue-100 flex flex-col items-center"
                    >
                      <span class="font-bold">15</span>
                      <span class="text-xs text-blue-500">0</span>
                    </div>
                    <div
                      class="bg-white rounded-lg p-2 border border-blue-100 flex flex-col items-center"
                    >
                      <span class="font-bold">16</span>
                      <span class="text-xs text-blue-500">2 consultas</span>
                    </div>
                  </div>
                </div>
                <!-- Botão carregar consulta no canto inferior direito do calendário -->
              </div>
            </div>
          </div>
        </div>
        <div class="p-6 w-full bg-white shadow-lg rounded-xl">
          <div class="flex items-center mb-4">
            <h1 class="text-2xl font-bold mr-2">Consultas Processadas</h1>
            <button
              id="btnRefresh"
              class="p-2 bg-blue-500 text-white rounded-full flex items-center justify-center hover:bg-blue-600"
              title="Atualizar Consultas"
            >
              <!-- Ícone de atualizar (SVG) -->
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 4v6h6M20 20v-6h-6M5 19a9 9 0 1 1 2.83-13.17M19 5a9 9 0 1 0-2.83 13.17"
                />
              </svg>
            </button>
          </div>
          <div id="listaEmpty" class="text-gray-500 italic mb-4 hidden">
            Nenhuma consulta encontrada
          </div>
          <!-- Consultas processadas organizadas por data -->
          <div id="lista" class="space-y-2">
            <!-- Exemplo de consulta expansiva -->
            <!--
        <details class="border rounded p-3 bg-gray-50">
          <summary class="cursor-pointer font-semibold flex justify-between items-center">
            <span>Consulta - 12/06/2024</span>
            <span class="text-xs text-gray-400">Paciente: Maria</span>
          </summary>
          <div class="mt-2 text-sm">
            <p><strong>Resumo:</strong> Consulta de rotina, exames realizados...</p>
            <p><strong>Detalhes:</strong> ...</p>
          </div>
        </details>
        -->
          </div>
        </div>
      </section>
    </main>
    <script src="app.js"></script>
  </body>
</html>
